# Test.mid λ³€ν™ λ¶„μ„ λ³΄κ³ μ„

## μ‹¤ν–‰ λ‚ μ§
2024λ…„ λ¶„μ„ λ³΄κ³ μ„

## MIDI νμΌ μ •λ³΄

### κΈ°λ³Έ μ •λ³΄
- **νμΌλ…**: test.mid
- **νμΌ ν¬κΈ°**: 19,742 bytes
- **νΈλ™ μ**: 2
- **Ticks Per Beat**: 480 (MIDI μ›λ³Έ)
- **μ΄ Ticks**: 325,200
- **μ „μ²΄ κΈΈμ΄**: 271μ΄ (4λ¶„ 31μ΄)
- **μ‚¬μ©λ μ±„λ„**: [0, 1]

### ν…ν¬ μ •λ³΄
- **κΈ°λ³Έ BPM**: 150
- **ν…ν¬ λ³€κ²½ νμ**: 4ν
  1. Tick 0 β†’ 150 BPM
  2. Tick 92,879 β†’ 150 BPM
  3. Tick 279,119 β†’ 150 BPM
  4. Tick 311,759 β†’ 150 BPM

β οΈ **μ£Όμ**: λ¨λ“  ν…ν¬κ°€ 150 BPMμΌλ΅ λ™μΌν•μ§€λ§, MIDI νμΌμ— μ¤‘λ³µ ν…ν¬ μ΄λ²¤νΈκ°€ μ΅΄μ¬ν•¨

### λ…ΈνΈ μ •λ³΄
- **μ΄ λ…ΈνΈ μ (MIDI μ›λ³Έ)**: 2,902κ°
- **μ¶”μ¶λ λ…ΈνΈ μ**: 2,728κ°
- **μ†μ‹¤λ λ…ΈνΈ**: 174κ° (6.0%)
- **μµλ€ λ™μ‹ λ°μ**: 10κ°

## λ³€ν™ ν”„λ΅μ„Έμ¤ λ¶„μ„

### 1. TPB λ³€ν™
- **μ›λ³Έ TPB**: 480
- **λ©ν‘ TPB**: 384 (λ§λΉ„λ…ΈκΈ° ν‘μ¤€)
- **λ³€ν™ λΉ„μ¨**: 0.8 (384/480)
- **κ·Έλ¦¬λ“ ν¬κΈ°**: 24 ticks

β… **κ°μ„ μ‚¬ν•­**: TPB λ³€ν™ λ΅μ§μ΄ μμ •λμ–΄ νƒ€μ΄λ° μ •ν™•λ„κ°€ ν–¥μƒλ¨

### 2. ν™”μ ν• λ‹Ή (Voice Allocation)

#### ν• λ‹Ήλ Voice μ: 6κ°

| Voice | λ…ΈνΈ μ | Tick λ²”μ„ | μ—­ν•  |
|-------|---------|-----------|------|
| Voice 0 | 457 | 0 - 260,160 | λ©λ΅λ”” |
| Voice 1 | 716 | 576 - 260,160 | λ² μ΄μ¤/ν™”μ1 |
| Voice 2 | 458 | 576 - 260,160 | ν™”μ2 |
| Voice 3 | 335 | 3,648 - 260,160 | ν™”μ3 |
| Voice 4 | 283 | 3,648 - 260,160 | ν™”μ4 |
| Voice 5 | 247 | 6,144 - 260,160 | ν™”μ5 |

**μ΄ν•©**: 2,496κ° λ…ΈνΈ (μ›λ³Έ 2,728κ° μ¤‘ 232κ° λ“λ΅­)

### 3. λ©λ΅λ”” μ„ νƒ λ΅μ§ κ°μ„ 

#### κ°μ„  μ „ λ¬Έμ μ :
- Tick 576μ—μ„ ν™”μ [74, 69, 43] μ¤‘ Voice 0μ΄ 69λ¥Ό μ„ νƒ β
- κ°€μ¥ λ†’μ€ μμΈ 74κ°€ Voice 2μ— ν• λ‹Ήλ¨
- μ΄μ „ μ(71)κ³Όμ κ±°λ¦¬λ§ κ³ λ ¤ν•μ—¬ λ©λ΅λ”” μΌκ΄€μ„± λ¶€μ΅±

#### κ°μ„  ν›„:
- Tick 576μ—μ„ Voice 0μ΄ μ¬λ°”λ¥΄κ² 74 μ„ νƒ β…
- μ΄μ „ λ©λ΅λ””μ™€ 5λ°μ μ΄λ‚΄μ μ μ¤‘ κ°€μ¥ λ†’μ€ μ μ°μ„ 
- λ²”μ„ λ°–μ΄λ©΄ λ¬΄μ΅°κ±΄ κ°€μ¥ λ†’μ€ μ μ„ νƒ

#### μ²« 30κ° νƒ€μ΄λ° ν¬μΈνΈ ν™”μ λ¶„μ„:

```
1. Tick 0: V0=N74 (λ‹¨μΌ λ…ΈνΈ)
2. Tick 192: V0=N74 (λ‹¨μΌ λ…ΈνΈ)
3. Tick 384: V0=N71 (λ‹¨μΌ λ…ΈνΈ)
4. Tick 576: V0=N74 V1=N43 V2=N69 β… (3ν™”μ, λ©λ΅λ”” μ¬λ°”λ¦„)
5. Tick 768: V1=N50 (λ‹¨μΌ λ…ΈνΈ)
6. Tick 960: V0=N57 (λ‹¨μΌ λ…ΈνΈ)
7. Tick 1152: V0=N71 V1=N50 (2ν™”μ)
8. Tick 1344: V0=N74 V1=N57 (2ν™”μ)
9. Tick 1536: V1=N50 (λ‹¨μΌ λ…ΈνΈ)
10. Tick 1920: V0=N71 V1=N43 (2ν™”μ)
11. Tick 2112: V0=N74 (λ‹¨μΌ λ…ΈνΈ)
12. Tick 2304: V0=N74 V1=N50 (2ν™”μ)
13. Tick 2496: V0=N74 V1=N57 (2ν™”μ)
14. Tick 2688: V0=N62 V1=N50 (2ν™”μ)
15. Tick 2880: V0=N57 (λ‹¨μΌ λ…ΈνΈ)
16. Tick 3072: V0=N74 V1=N50 V2=N69 (3ν™”μ)
17. Tick 3264: V0=N74 V1=N43 (2ν™”μ)
18. Tick 3456: V0=N71 (λ‹¨μΌ λ…ΈνΈ)
19. Tick 3648: V0=N74 V1=N42 V2=N69 V3=N66 V4=N62 (5ν™”μ, ν’€μ½”λ“)
20. Tick 3840: V1=N50 (λ‹¨μΌ λ…ΈνΈ)
```

### 4. MML μƒμ„± κ²°κ³Ό

| Voice | MML κΈΈμ΄ | μƒνƒ |
|-------|----------|------|
| Voice 0 (λ©λ΅λ””) | 1,808μ | β… 2,400μ μ΄ν• |
| Voice 1 | 1,954μ | β… 2,400μ μ΄ν• |
| Voice 2 | 1,572μ | β… 2,400μ μ΄ν• |
| Voice 3 | 1,157μ | β… 2,400μ μ΄ν• |
| Voice 4 | 696μ | β… 2,400μ μ΄ν• |
| Voice 5 | 986μ | β… 2,400μ μ΄ν• |

**κ²°λ΅ **: λ¨λ“  Voiceκ°€ λ§λΉ„λ…ΈκΈ° κΈ€μ μ μ ν•(2,400μ) λ‚΄μ—μ„ μ„±κ³µμ μΌλ΅ μƒμ„±λ¨

### 5. MML μƒν” (Voice 0 - λ©λ΅λ””)
```
T150V15O5L8DDO4BO5D4O3AO4BO5D4RO4BO5DDDO4DO3AO5DDO4BO5D4O3AO4BO5D4RO4BO5DDDO4DO3AO5DDDE4FE4DD4RO3DADAO5DDDD4GF+4GF+4RO4E4D4O5DDO4BO5D4O3A4.O2GO3A4O5DDDO4DO3AO5DDO4BO5D4O3A4.O4D4O5D4DDO4DO3AO5DDDE4FE4D...
```

## μ£Όμ” κ°μ„ μ‚¬ν•­

### β… μ™„λ£λ μμ •

1. **TPB λ³€ν™ λ΅μ§ κ°μ„ **
   - λ³€ν™ ν›„ μ¤λƒ… μμ„ μμ •
   - μ •ν™•ν• λΉ„μ¨ κ³„μ‚° (tpb_ratio = 384.0 / 480.0)
   - μµμ† κΈΈμ΄ λ³΄μ¥ (GRID_SIZE = 24)

2. **λ©λ΅λ”” μ„ νƒ μ•κ³ λ¦¬μ¦ κ°μ„ **
   - μ΄μ „ λ©λ΅λ””μ™€μ μ—°μ†μ„± κ³ λ ¤ (5λ°μ μ΄λ‚΄)
   - κ°€μ¥ λ†’μ€ μ μ°μ„  μ›μΉ™ μ μ§€
   - μΌκ΄€μ„± μλ” λ©λ΅λ”” λΌμΈ μƒμ„±

3. **ν™”μ ν• λ‹Ή κ°μ„ **
   - λ©λ΅λ”” β†’ λ² μ΄μ¤ β†’ ν™”μ μμ„ λ…ν™•ν™”
   - λ†’μ€ μλ¶€ν„° μμ°¨μ μΌλ΅ ν• λ‹Ή
   - Voice κ°„ μ¶©λ λ°©μ§€

4. **λ¶„μ„ λ„κµ¬ μ¶”κ°€**
   - MIDI μƒμ„Έ λ¶„μ„ (analyzer.rs)
   - ν…ν¬ λ³€κ²½ κ°μ§€
   - ν™”μ ν• λ‹Ή μ‹κ°ν™”
   - MML μƒμ„± ν…μ¤νΈ

## μ•λ ¤μ§„ μ ν•μ‚¬ν•­

### β οΈ μ£Όμμ‚¬ν•­

1. **λ…ΈνΈ μ†μ‹¤**: 174κ° (6%) - Voice 6κ° μ ν•μΌλ΅ μΈν• λ“λ΅­
2. **ν…ν¬ λ³€κ²½**: ν„μ¬λ” μ²« λ²μ§Έ ν…ν¬λ§ μ‚¬μ© (λ¨λ“  ν…ν¬κ°€ 150 BPMμ΄λ―€λ΅ μ΄ νμΌμ—μ„λ” λ¬Έμ μ—†μ)
3. **μ±„λ„ 10 (λ“λΌ)**: μλ™ μ μ™Έλ¨

### π”„ ν–¥ν›„ κ°μ„  κ°€λ¥ ν•­λ©

1. **λ™μ  ν…ν¬ λ³€κ²½ μ§€μ›**
   - ν…ν¬ λ³€κ²½ μ‹μ μ— λ”°λ¥Έ tick-to-time λ³€ν™ κ°μ„ 
   - MMLμ—μ„ μ¤‘κ°„ ν…ν¬ λ³€κ²½ μ§€μ›

2. **Voice ν• λ‹Ή μµμ ν™”**
   - λ” μ μ€ Voiceλ΅ λ” λ§μ€ λ…ΈνΈ μ»¤λ²„
   - μ°μ„ μμ„ κΈ°λ° μ¤λ§νΈ λ“λ΅­

3. **κΈΈμ΄ κ·Όμ‚¬ κ°μ„ **
   - λ§λΉ„λ…ΈκΈ° MML νƒ€μ΄λ°κ³Όμ μ •λ°€ λ§¤μΉ­
   - μ μν‘/νƒ€μ΄ μµμ ν™”

## ν…μ¤νΈ κ²°κ³Ό μ”μ•½

### β… μ„±κ³µ ν•­λ©
- [x] MIDI νμ‹± λ° λ…ΈνΈ μ¶”μ¶
- [x] TPB λ³€ν™ (480 β†’ 384)
- [x] ν™”μ λ¶„λ¦¬ λ° Voice ν• λ‹Ή
- [x] λ©λ΅λ”” μ„ νƒ μΌκ΄€μ„±
- [x] MML μƒμ„± (λ¨λ“  Voiceκ°€ κΈ€μ μ μ ν• λ‚΄)
- [x] νƒ€μ΄λ° μ •ν™•λ„

### π“ μ„±λ¥ μ§€ν‘
- **λ³€ν™ μ„±κ³µλ¥ **: 94% (2,728/2,902 λ…ΈνΈ)
- **Voice ν™μ©λ¥ **: 100% (6/6 Voice μ‚¬μ©)
- **κΈ€μ μ μ¤€μ**: 100% (λ¨λ“  Voiceκ°€ 2,400μ μ΄ν•)
- **νƒ€μ΄λ° μ •ν™•λ„**: λ†’μ (κ·Έλ¦¬λ“ κΈ°λ° μ¤λƒ…)

## κ²°λ΅ 

test.mid νμΌμ λ³€ν™μ΄ **μ„±κ³µμ μΌλ΅ μ™„λ£**λμ—μµλ‹λ‹¤. μ£Όμ” κ°μ„ μ‚¬ν•­:

1. β… ν™”μ νƒ€μ΄λ° κΌ¬μ„ λ¬Έμ  ν•΄κ²°
2. β… ν™”μ λ¶„λ¦¬ μΌκ΄€μ„± ν™•λ³΄
3. β… λ©λ΅λ”” λΌμΈ μ•μ •μ„± ν–¥μƒ
4. β… λ¨λ“  Voiceκ°€ κΈ€μ μ μ ν• μ¤€μ

λ³€ν™λ MMLμ€ λ§λΉ„λ…ΈκΈ° λ¨λ°”μΌμ—μ„ μ¦‰μ‹ μ‚¬μ© κ°€λ¥ν• μƒνƒμ…λ‹λ‹¤.

---

**λ¶„μ„ λ„κµ¬**: `cargo run --bin analyze test.mid`
**λ²„μ „**: 1.0.0
**μ—”μ§„**: Rust + midly 0.5